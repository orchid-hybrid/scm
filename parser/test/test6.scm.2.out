(define (finish-reading-char input-stream)
  (define (assert-code codes)
    (if (null? code)
      #f
      (if (equal? (car codes) (read-char input-stream))
        (assert-code (cdr codes))
        (error "unknown character code"))))
  (let ((first-char (read-char input-stream)))
    (cond ((whitespace? (peek-char input-stream)) first-char)
          ((equal? #\s first-char) (assert-code '(#\p #\a #\c #\e)) #\space)
          ((equal? #\n first-char)
           (assert-code '(#\e #\w #\l #\i #\n #\e))
           #\newline)
          (else (error "unknown character code")))))
